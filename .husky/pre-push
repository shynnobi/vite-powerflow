#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ§ª Running tests before push..."

# Check if E2E test files exist
if [ -n "$(find tests/e2e -name '*.spec.ts' -o -name '*.test.ts' 2>/dev/null)" ]; then
  echo "ğŸ“ E2E tests found. Running all tests..."
  pnpm test:all
else
  echo "ğŸ“ No E2E test files found. Running only unit and integration tests..."
  pnpm test
fi

# Capture the exit code of the previous command
if [ $? -ne 0 ]; then
  echo "âŒ Tests failed. Push aborted."
  exit 1
fi

echo "âœ… All tests passed. Proceeding with push..."
